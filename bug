#
# This file is a reminder to myself for things that I've noticed that need
# to be implemented, fixed or thought about.  Items checked [x] have been 
# completed.  My goal is to clean up all outstanding issues before releasing
# version 1.0.
#

[ ] add primitives down one level with affine transformations?

[x] fill4.ps shows how to fill with a stipple.  Make ps plots properly stipple

[ ] forcing exit by typing "bye bye" should clear autosave file for all unsaved cells
[x] should periodically save cells/DEV.autosave, when starting ask "crash rep found, readin instead?"  
      While editing
	  if modified and idle for more than XX seconds, or if time
	  since last save is greater than YY save current modified DEV
	  to cells/DEV.autosave, clear modification flag
      While reading in
      	  if cells/DEV.autosave is newer than cells/DEV.d then ask:
	  crash rep found, readin instead?  If yes, then readin crash
	  rep as the .d

[ ] should store disk mod time and readin-time in db_tab for all cells. 
    Use to check if version on disk was changed since readin and before writing out. 
    If so, then give user a chance to write to an different name. 
    Re-editing a cell in memory should also invoke the check and ask:
    "Definition on disk has changed, discard memory copy and reread?  (y/n)"
    Geom_inst now reads and prints mod times as it reads in cells.

[x] com_grid should allow a single argument and default second to "1"

[x] using FSIZE should change the PIG_FONT_SIZE env variable.  It should be 
    equivalent using the command or using the env var.

[ ] xwin_window_set sets needs_redraw++;  This is normally needed, but if I want
to prevent a redraw when resizing a big drawing, then it is a problem.

[x] (2.5+(1.6/2)) gives "BAD-EXPRESSION"
[x] implement $$ comments character (ignore to EOL)
[ ] all CMDs should stay in CMD after EOC - only change state on another CMD
    [ ] com_add.c
	[ ] geom_arc.c
	[ ] geom_circle.c
	[ ] geom_inst.c
	[x] geom_line.c
	[ ] geom_poly.c
	[ ] geom_rect.c
	[ ] geom_text.c
    [ ] com_area.c
    [ ] com_change.c
    [x] com_copy.c
    [ ] com_delete.c
    [ ] com_distance.c
    [ ] com_equate.c
    [ ] com_ident.c
    [x] com_move.c
    [ ] com_point.c
    [ ] com_smash.c
    [ ] com_stretch.c
    [ ] com_undo.c
    [ ] com_window.c
    [ ] com_wrap.c
[ ] all commands need to treat IDENT (eg: macro) as a potential CMD

[x] moving notes doesn't keep outline visible
[x] MOV :R shouldn't show all individual devices, just bounding box, too slow
[x] MOV :R hangs up in "got EOL" loop;
[x] plot and dump should take an output filename as a final option.

[x] find and readin pigrc/.pigrc files


[ ] problem in com_wrap()? 
[ ] should all commands do snapxy on coordinates?  Currently handtyped coordinates
    are not snapped.

[+] MACROS, SCRIPTPATH (partially done)
[ ] -next, -region -point soft keys
[ ] fix highlighting - just make it white, no xor-box

[-] make CHA :MX,MY,etc work on polygons - just redefine with transformed pts - will
    need pivot point  (not so important since we can WRAP them and then CHA them).

[ ] Retrieving something that shares cells with something already being edited
    creates lots of error messages (eg: retrieve slic followed by tone).  

[ ] fixed coredump in db_ident2 by eliminating a selpnt_clear() call at the
    expense of possible memory leak.  partially fixed it by doing selpnt_clear
    in com_move().  Should get rid of multiple uses of selpnt address in
    com_move and com_stretch.  all calls to selpnt_clear() should be in one place.

[ ] make text stretchable

[ ] do_line using static array for reverse boundary storage
[ ] polygons ignore :W option (can implement as a line type?)
[ ] bailing out of STR with ";" leaves bounding box
[ ] saving FOO as BAR should purge any BAR in memory, or at least ask 
[ ] COPY :R should show individual components, not just bounding box
[ ] need autosave feature - time?  number of commands?

[ ] SMA is funny, requiring a double click, but not EOC.  think about better definition.

[ ] CHA :R for fixing font size, orientation, changing graph label font
    sizes en-masse, etc. 

[ ] need an alternative way to draw an arc: center, first point of
    circumference, second point on circumference, draw cw. 

[ ] there is a lag between showing primitives and sub-cells with win :n-1, win:n9
[x] postscript doesn't carry through line types
[ ] postscript output should optionally be hierarchical
[x] postscript output should allow filled objects 
[ ] warning message on exit if proc modified from readin.

[x] ADD I should suppress double click (don't add two insts)
[x] some problem printing portrait mode postscript, doesn't fit boundary properly
[x] make text filled.
[x] ADD L: double clicking on same point makes single line in the .d file
[x] cop :r leaves rubber box if terminated with ";"
[x] del :r leaves rubber box if terminated with ";"
[x] limit testing on EQU :F (stipple fill argument)
[x] archiving something with a wrap NONAME instance saves the noname.
[x] SMASH :R
[x] make comma optional between coords
[x] IDE should print out a line that can be cut/pasted
[x] WIN :Z
[x] retrieving smorgasboard bad ident bounding boxes until saved and re-edited
[x] Double wrapping deletes an item! (was bad update of dbhead->prev)
[x] ; doesn't terminate COP
[x] EQU :O<layer> in edit mode  (superceded by WIN :O<layer>);
[x] cut/paste operation in text window
[x] when you do a readin, the global static from token_get is destroyed
[x] token_get(lp, char *word)  crashes when word is bigger than caller's buffer 

[x] ENV variables
[x] SHELL out

[x] make newlines in text/note strings work

[x] postscript has many duplicated lines

[x] make window zoom in/out by middle clicking/hold and drag right/left.  Single middle click centers window.
[x] clipping bug when large lower rectangle cuts bottom half of screen
[x] win command in .d file can have exponential notation
[x] db_highlight should always use WHITE xor, not current grid color, otherwise highlighting
    doesnt work on lines drawn in the same color as grid.
[x] wrap should complain earlier when show is not set
[?] smashing a NONAME with a justified label makes a mess (can't replicate yet)
[x] need to update man page for EQU options
[x] can add l0, but can't CHAnge a line to layer 0
[x] mov doesn't work with point mode yet (redo db_ident to return selpnt struct).
[x] adding a line and then drawing an arrowhead causes coord to be dropped
[x] dropping a rep with COP leaves highlighting on
[x] mov should not obey lock angle
[x] mov :r doesn't move ARCs!
[x] MOV :R should show individual components, not just bounding box - bad idea!
[x] don't let ADD note/text double enter on the same coord
[x] make db_highlight show origin for instance, text, note, circles
[x] str with a double click sets coord to 0,0 - should abort command
[x] STR :R highlights cells with no pull points in BB
[x] STR :R needs dynamic buffer alloc, not just 1024 points
[x] bounding  box for rotated instances draw as unrotated/mirrored
[x] I doesn't work for a move descriptor
[x] a VCC triangle on top of a wire is hard to select, see multibus schematic

[x] need del :r
[x] stop doing callbacks when in menu area
[x] using cell name doesn't work for restrictor in com_move (and others)
[x] wrap won't take an inst name
[x] str sometimes is stuck in :r mode, :p will fix, maybe static variable?
[x] double clicking on STR with a polygon causes a sudden jump in coords.
[x] interaction with MOV and SHO.  Sometimes MOV moves things that have been set "SHO -E".
[x] can allow arbitrary rotations in SMA and WRA if rectangles are converted to polys
[x] make CHA command prohibit shearing and aspecting of NONAMEs
[x] when exiting, don't warn of unsaved NONAMES
[x] smash, including autosmash should handle rotations and mirrors.
[x] automatically smash NONAMES (added is_tmp_rep variable in db_tab definition and set to 1 for auto wraps insts)

[x] if second point of add line is 0,0 will drop coord
[x] search path for font,note,proc,menu

[x] in .d files, WIN command sometimes has scientific notation for points close to zero

[x] com_copy can't do multiple copies with :R because stack is exhausted
[x] autogenerate NONAMES in WRAP
[x] save non-NONAME wrapped devices names when created
[x] MOV doesn't move instances (some problem with db_ident() wildcarding)

[x] working on com_ident to prototype pick by region.

[x] postscript output should be cropped (fixed several subtle bugs...)

[x] let EQU :M take numeric arguments for more line types

[x] bounding box for adding a scaled instance is wrong size


[x] ARCS fail to degenerate properly if three points are collinear

[x] DEL is broken.  When editing PLAN, try deleting the front porch. 
    Lots of other shapes die first.  Ident, on the other hand does the
    right thing.  {was an uninitialized variable problem}

[x] If you edit PLAN, then edit PLAN2, then edit and click on PLAN
    sub-cell, boom!  segfault at line 127 in com_edit(). 

[x] Working on show sets.  Pointer to currep is now passed to all show
    set routines, each rep now has showset structure in DB_TAB.  Just
    need to properly initialize the structures on creation, and then mod
    show_set_modify()...  to use the pointer rather than a global. 

